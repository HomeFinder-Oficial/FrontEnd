<main class="w-full min-h-screen p-10">
  <section class="flex justify-between">
    <div class="flex items-center gap-20">
      <h1 class="text-3xl font-bold">Usuarios</h1>
      <div class="w-[350px] h-[40px]">
        <input
          type="text"
          class="!w-full !h-full"
          pInputText
          [(ngModel)]="value"
          placeholder="Buscar..."
        />
      </div>
    </div>
    <div class="w-[137px] h-[35px]">
      <p-button label="Añadir Usuario" (onClick)="showDialog('Crear')" />
    </div>
  </section>
  <div class="w-[243px] h-[80px] mt-10 flex items-center rounded-lg px-7 gap-3">
    <div class="flex items-center justify-center w-[50px] h-[50px] rounded-full bg-[#fce3b1]">
      <i class="pi pi-user" style="font-size: 1.5rem; color: #fdb52a"></i>
    </div>
    <div>
      <p class="m-0 p-0 text-gray-500">Total Usuarios</p>
      <p class="m-0 p-0 text-sm font-bold">{{ totalUsers }}</p>
    </div>
  </div>
  <div class="card mt-8 flex flex-col gap-5 rounded-lg p-6">
    <h2 class="text-xl font-bold">Lista de Usuarios</h2>
    @if (!loading){
      <p-table
        [value]="dataTable"
        [paginator]="true"
        [rows]="size"
        [totalRecords]="totalUsers"
        [tableStyle]="{ 'min-width': '50rem' }"
        [rowsPerPageOptions]="[1, 5, 10]"
        (onPage)="onPageChange($event)"
      >
        <ng-template #header>
          <tr>
            <th style="width: 22%">Nombre</th>
            <th style="width: 22%">Telefono</th>
            <th style="width: 22%">Rol</th>
            <th style="width: 22%">Estado</th>
            <th style="width: 10%">Acciones</th>
          </tr>
        </ng-template>
        <ng-template #body let-dataTable>
          <tr>
            <td>
              <div class="flex items-center gap-3">
                <img
                  [src]="dataTable.foto"
                  alt="{{ dataTable.nombre }}"
                  class="w-10 h-10 rounded-full"
                />
                {{ dataTable.nombre }}
              </div>
            </td>
            <td>{{ dataTable.telefono }}</td>
            <td>{{ dataTable.rol }}</td>
            <td>
              <span
                class="px-3 py-1 rounded-full text-sm font-semibold"
                [ngClass]="
                  dataTable.activo ? 'text-green-700 bg-green-100' : 'text-gray-500 bg-gray-200'
                "
              >
                {{ dataTable.activo ? 'Activo' : 'Inactivo' }}
              </span>
            </td>
            <td>
              <button
                pButton
                type="button"
                icon="pi pi-pencil"
                class="p-button-text p-button-plain"
                (click)="showDialog('Actualizar')"
              ></button>
              <button
                pButton
                type="button"
                icon="pi pi-trash"
                class="p-button-text p-button-plain"
              ></button>
            </td>
          </tr>
        </ng-template>
      </p-table>
    }
  </div>
  <p-dialog
    header="{{ dialogType }} Usuario"
    [modal]="true"
    [(visible)]="visible"
    [style]="{ width: '600px' }"
  >
    <div class="flex items-center gap-4 mb-4">
      <label for="Nombre" class="font-semibold w-24">Nombre Completo</label>
      <input pInputText id="Nombre" class="flex-auto" autocomplete="off" />
    </div>
    <div class="flex items-center gap-4 mb-8">
      <label for="email" class="font-semibold w-24">Email</label>
      <input pInputText id="email" class="flex-auto" autocomplete="off" />
    </div>
    <p-fileUpload
      #fu
      name="demo[]"
      [multiple]="false"
      accept="image/*"
      maxFileSize="1000000"
      mode="basic"
    >
    </p-fileUpload>
    <div class="flex items-center gap-4 mb-4">
      <label for="password" class="font-semibold w-24">Contraseña</label>
      <input pInputText id="password" class="flex-auto" autocomplete="off" />
    </div>

    <div class="flex items-center gap-4 mb-4">
      <label for="phone" class="font-semibold w-24">Teléfono</label>
      <input pInputText id="phone" class="flex-auto" autocomplete="off" />
    </div>

    <div class="flex justify-end gap-2">
      <p-button label="Cancel" severity="secondary" (click)="visible = false" />
      <p-button
        label="Save"
        (onClick)="dialogType === 'Actualizar' ? submitUpdate() : submitCreate()"
      />
    </div>
  </p-dialog>
</main>
