<!-- <p>properties-dashboard works!</p> -->
 <div class="d-flex flex-row flex-shrink-0 row">
  <div class="col-3 flex-column sidebar-fixed">
    <!-- Here you can add additional content for the sidebar if needed -->
  </div>
  <div class="col-9 flex-column flex-grow-1 p-3">
    <!-- CLONE: Specific Dashboard Title -->
    <div class="row">
      <div class="col-12">
        <h1 class="text-center">Gestión de propiedades</h1>
      </div>
    </div>

    <!-- CLONE: Data Table -->
    <div class="row justify-content-center">
      <div class="col-12">
        <!-- Table -->
        <p-table
            #dt
            [value]="properties"
            [rows]="10"
            [paginator]="true"
            [globalFilterFields]="['name', 'country.name', 'representative.name', 'status']"
            [tableStyle]="{ 'min-width': '75rem' }"
            [(selection)]="selectedProperties"
            [rowHover]="true"
            dataKey="id"
            currentPageReportTemplate="Showing {first} to {last} of {totalRecords} property entries"
            [showCurrentPageReport]="true"

            [rowsPerPageOptions]="[10, 25, 50]"
            class="p-datatable-sm p-datatable-striped"
        >
            <!-- Top Bar -->
            <ng-template #caption>
                <div class="flex items-center justify-between">
                    <!-- LEFT: Export Action Buttons -->
                    <div>
                        <!-- <button pButton pRipple icon="pi pi-file-excel" (click)="exportExcel(dt)" class="p-button-help mr-2" pTooltip="Exportar a Excel"></button> -->
                        <!-- <p-fileUpload mode="basic" accept="image/*" [maxFileSize]="1000000" label="Import" chooseLabel="Import" auto customUpload class="mr-2 inline-block" [chooseButtonProps]="{ severity: 'secondary' }" /> -->
                        <p-button label="Exportar CSV" icon="pi pi-upload" severity="secondary" (click)="exportCSV(dt)" class="mr-2" pTooltip="Exportar a CSV" />
                        <p-button label="Exportar PDF" icon="pi pi-file-pdf" severity="secondary" (click)="exportPDFDownload(dt)" class="p-button-danger mr-2" pTooltip="Exportar a PDF" />
                        <p-button label="Imprimir" icon="pi pi-print" severity="info" (click)="exportPdfPreview(dt)" class="p-button-danger mr-2" pTooltip="Imprimir" />
                    </div>

                    <!-- CENTER: Search Input -->
                    <div class="text-center">
                        <span class="p-input-icon-left ml-auto">
                        <p-iconfield>
                            <p-inputicon class="pi pi-search" />
                            <input pInputText type="text" (input)="dt.filterGlobal($event.target.value, 'contains')" placeholder="Buscar propiedad..." />
                        </p-iconfield>
                        </span>
                    </div>

                    <!-- RIGHT: Dropdown for rows per page -->
                    <div class="flex items">
                        <span class="mr-2">Mostrar:</span>
                            <p-select 
                                [options]="rowsPerPageOptions" 
                                [(ngModel)]="rows"
                                size="small"
                                variant="filled"
                                class="w-full md:w-56 p-inputtext-sm"
                            >
                            </p-select>
                        <span class="ml-2">registros</span>
                    </div>
                </div>
            </ng-template>

            <!-- Table Headers and Body -->
            <ng-template #header>
                <tr>
                    <th style="width: 3rem">
                        <p-tableHeaderCheckbox />
                    </th>
                    <th style="min-width: 16rem">Id</th>
                    <th pSortableColumn="title" style="min-width:16rem">
                        <div class="flex items-center gap-2">
                            Title
                            <p-sortIcon field="title" />
                        </div>
                    </th>
                    <th>Description</th> <!-- TASK: It would be hidden by his characters extension -->
                    <th pSortableColumn="price" style="min-width: 8rem">
                        <div class="flex items-center gap-2">
                            Price
                            <p-sortIcon field="price" />
                        </div>
                    </th>
                    <th pSortableColumn="area_m2" style="min-width:10rem">
                        <div class="flex items-center gap-2">
                            Area (m²)
                            <p-sortIcon field="area_m2" />
                        </div>
                    </th>
                    <th pSortableColumn="rooms" style="min-width: 12rem">
                        <div class="flex items-center gap-2">
                            Habitaciones
                            <p-sortIcon field="rooms" />
                        </div>
                    </th>
                    <th pSortableColumn="baths" style="min-width: 12rem">
                        <div class="flex items-center gap-2">
                            Baños
                            <p-sortIcon field="baths" />
                        </div>
                    </th>
                    <th pSortableColumn="active" style="min-width: 12rem">
                        <div class="flex items-center gap-2">
                            Activa
                            <p-sortIcon field="active" />
                        </div>
                    </th>
                    <th>Acciones</th>
                    <!-- owner_id, property_type_id, location_id -->
                    <th style="min-width: 12rem"></th>
                </tr>
            </ng-template>
            <ng-template #body let-property>
                <tr>
                    <td style="width: 3rem">
                        <p-tableCheckbox [value]="property" />
                    </td>
                    <td style="min-width: 12rem">{{ property.id }}</td>
                    <td style="min-width: 16rem">{{ property.title }}</td>
                    <!-- <td style="min-width: 16rem">{{ property.description }}</td> --><!-- TASK: It would be hidden by his characters extension -->
                    <td>{{ property.price | currency: 'COP' }}</td>
                    <td>{{ property.area_m2 }}</td>
                    <td>{{ property.rooms }}</td>
                    <td>{{ property.bathrooms }}</td>
                    <td><p-tag [value]="property.active ? 'Activa' : 'Inactiva'" [severity]="property.active ? 'success' : 'danger'"></p-tag></td>
                    <!--
                    <td>
                        <p-rating [(ngModel)]="property.rating" [readonly]="true" [cancel]="false" />
                    </td>
                    <td>
                        <p-tag [value]="property.inventoryStatus" [severity]="getSeverity(property.inventoryStatus)" />
                    </td>
                    <td>
                        <img [src]="'https://primefaces.org/cdn/primeng/images/demo/property/' + property.image" [alt]="property.title" style="width: 64px" class="rounded" />
                    </td>
                    -->
                    <td>
                        <p-button icon="pi pi-pencil" class="mr-2" [rounded]="true" [outlined]="true" (click)="seeProperty(property)" />
                        <p-button icon="pi pi-pencil" class="mr-2" [rounded]="true" [outlined]="true" (click)="editProperty(property)" />
                        <p-button icon="pi pi-trash" severity="danger" [rounded]="true" [outlined]="true" (click)="deleteProperty(property)" />
                    </td>
                </tr>
            </ng-template>

            <!-- LEFT: Create and Delete Action Buttons -->
            <ng-template pTemplate="paginatorleft">
                <p-button label="New" icon="pi pi-plus" class="mr-2" (onClick)="showDialog()" />
                <p-button severity="danger" label="Delete" icon="pi pi-trash" outlined (onClick)="deleteSelectedProperties()" [disabled]="!selectedProperties || !selectedProperties.length" />
            </ng-template>

            <!-- CENTER: Pagination Controls -->

            <!-- RIGHT: Show Rows Per Page Text -->
        </p-table>
      </div>
    </div>
  </div>
</div>

<!-- CLONE: Dialog to create, edit or view a property -->
<!--
<p-dialog [(visible)]="propertyDialog" [style]="{ width: '450px' }" header="Property Details" [modal]="true">
    <ng-template #content>
        <div class="flex flex-col gap-6">
            <img [src]="'https://primefaces.org/cdn/primeng/images/demo/property/' + property.image" [alt]="property.image" class="block m-auto pb-4" *ngIf="property.image" />
            <div>
                <label for="name" class="block font-bold mb-3">Name</label>
                <input type="text" pInputText id="name" [(ngModel)]="property.name" required autofocus fluid />
                <small class="text-red-500" *ngIf="submitted && !property.name">Name is required.</small>
            </div>
            <div>
                <label for="description" class="block font-bold mb-3">Description</label>
                <textarea id="description" pTextarea [(ngModel)]="property.description" required rows="3" cols="20" fluid></textarea>
            </div>

            <div>
                <label for="inventoryStatus" class="block font-bold mb-3">Inventory Status</label>
                <p-select [(ngModel)]="property.inventoryStatus" inputId="inventoryStatus" [options]="statuses" optionLabel="label" optionValue="label" placeholder="Select a Status" fluid />
            </div>

            <div>
                <span class="block font-bold mb-4">Category</span>
                <div class="grid grid-cols-12 gap-4">
                    <div class="flex items-center gap-2 col-span-6">
                        <p-radiobutton id="category1" name="category" value="Accessories" [(ngModel)]="property.category" />
                        <label for="category1">Accessories</label>
                    </div>
                    <div class="flex items-center gap-2 col-span-6">
                        <p-radiobutton id="category2" name="category" value="Clothing" [(ngModel)]="property.category" />
                        <label for="category2">Clothing</label>
                    </div>
                    <div class="flex items-center gap-2 col-span-6">
                        <p-radiobutton id="category3" name="category" value="Electronics" [(ngModel)]="property.category" />
                        <label for="category3">Electronics</label>
                    </div>
                    <div class="flex items-center gap-2 col-span-6">
                        <p-radiobutton id="category4" name="category" value="Fitness" [(ngModel)]="property.category" />
                        <label for="category4">Fitness</label>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-12 gap-4">
                <div class="col-span-6">
                    <label for="price" class="block font-bold mb-3">Price</label>
                    <p-inputnumber id="price" [(ngModel)]="property.price" mode="currency" currency="USD" locale="en-US" fluid />
                </div>
                <div class="col-span-6">
                    <label for="quantity" class="block font-bold mb-3">Quantity</label>
                    <p-inputnumber id="quantity" [(ngModel)]="property.quantity" fluid />
                </div>
            </div>
        </div>
    </ng-template>

    <ng-template #footer>
        <p-button label="Cancel" icon="pi pi-times" text (click)="hideDialog()" />
        <p-button label="Save" icon="pi pi-check" (click)="savePropertyChanges()" />
    </ng-template>
</p-dialog>
-->
<!-- CLONE: Confirmation Dialog to logically delete a property -->
<p-toast></p-toast>
<p-confirmDialog [style]="{width: '450px'}"></p-confirmDialog>